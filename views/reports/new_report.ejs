<% layout("layouts/boilerplate") %>
<% pageTitle = "New Report" %>
<% pageClass = "new-report-page" %>



<div class="report-page">
  <div class="report-wrapper">

    <h1 class="report-title">Create New Report</h1>
    <p class="report-subtitle">Upload a retinal image and enter patient details.</p>

    <form action="/reports" method="POST" enctype="multipart/form-data" class="report-form">

      <!-- AGE -->
      <div class="field">
        <label for="age">Age</label>
        <input type="number" id="age" name="report[age]" required />
      </div>

      <!-- SEX -->
      <div class="field">
        <label for="sex">Sex</label>
        <select id="sex" name="report[sex]" required>
          <option value="">Select</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
        </select>
      </div>

      <!-- BMI -->
      <div class="field">
        <label for="bmi">BMI</label>
        <input type="number" step="0.1" id="bmi" name="report[BMI]" required />
      </div>

      <!-- SMOKING STATUS -->
      <div class="field">
        <label for="smokingStatus">Smoking History</label>
        <select id="smokingStatus" name="report[smokingStatus]" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
          <option value="Unknown">Unknown</option>
        </select>
      </div>

           <!-- FUNDUS IMAGE -->
      <div class="field">
        <label for="image">Fundus Image</label>

        <div class="upload-box" id="uploadBox">
          <span class="upload-icon">ğŸ‘ï¸â€ğŸ—¨ï¸</span>
          <p class="upload-text">Click to upload fundus image</p>
          <p class="upload-file-name" id="fileName">No file chosen</p>
        </div>

        <input
          type="file"
          id="image"
          name="image"
          accept="image/*"
          required
          hidden
        />
      </div>

      <!-- SUBMIT BUTTON -->
      <button type="submit" class="btn-submit">
        Generate Report
      </button>

    </form>

  </div>
</div>

<script>
  const uploadBox = document.getElementById("uploadBox");
  const imageInput = document.getElementById("image");
  const fileNameText = document.getElementById("fileName");

  uploadBox.addEventListener("click", () => {
    imageInput.click();
  });

  imageInput.addEventListener("change", () => {
    fileNameText.textContent =
      imageInput.files.length > 0
        ? imageInput.files[0].name
        : "No file chosen";
  });
</script>

